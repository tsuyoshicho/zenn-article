---
title: "Zennでのコンテンツ管理でのトラブル事例"
emoji: "🤔"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["Zenn", "GitHub"]
published: true
---

 [4ステップでGithubからZennに記事を公開してみる(トラブルシューティング付き) | Zenn](https://zenn.dev/ohbashunsuke/articles/20200917001-deploy-with-github) を閲覧しまして、自分が遭遇した事例も紹介したほうがよさそうかな、と小記事にしました。

## Zennコンテンツ管理リポジトリの改名

### 状態

自分は最初からZennをリポジトリ管理しているのですが、最初のリポジトリ名は `zenn-article` というものでした。

これは記事だけいれればいいか、くらいから名付けましたが。

- booksないから本は入れない予定なんだね、とslackで突っ込まれた（一応そのうちやってみたくはあった）。
- 単数なので微妙

というのもあり、改名しました。 [tsuyoshicho/zenn-articles-and-books](https://github.com/tsuyoshicho/zenn-articles-and-books)


### 問題

改名自体はGitHub上でやるだけですので、問題はなく行えました。
ただ当然といえば当然なのですが、連携しているリポジトリとしては見なされなくなっていました。

なので、連携解除後、再度このリポジトリを対象として連携しました。
（このあたりは最初にある別記事を参照していただくと判りやすいです）

これによって記事やその Like 状態がどうなるか心配だったのですが、引き継がれたようでなによりです。

### 結論

リポジトリの改名はさほど負担ありません。

## Zennコンテンツ管理リポジトリの管理

### 管理

さて、せっかくリポジトリを作ったので、ここでの記事追加をブランチ->PR->マージの流れでやりたいと思い整備します。

詳細はリポジトリを見てもらうとして、GitHub workflow で `textlint` で記事をチェックするようにしています。
また、Zenn CLIを含めて関係パッケージも増えますので、 Renovate での更新を設定しています。

### 問題

逆に初期化の際ちょっとサボって自分でつくったため、`npx zenn-cli init` をしておらず、ちょっと変になってた部分もありました。
別箇所で `init` し、その内容を反映して整形しています。

### 結論

ちゃんと手引きにそって初期化してから始めるのがよいでしょう。
また、リポジトリ管理にしているなら、GitHub workflowは活用の幅が広いです。

## Zennコンテンツのslug

### 序

さて、リポジトリで管理しているので slug は任意のものが付けられます。

### 問題

最初は記事の順序性なんてないし、明確な記事の内容が分るものでいいだろう、と思っていました。
ですが、記事の内容って陳腐化というか古いがゆえに参考にならなくなる、というのはあるのでslugに日付が入っていると明確でよさそうと思いなおしました。
（某slackでの会話でも「日付があったほうがいいのでは」と指摘が別の記事にされました）

そこで、記事ファイルを rename しました。

ここで更新したファイル名をマージしたところ、旧来の slug での記事 （バックエンドなし） と新規が併存するようになりました。
古い記事は削除しています。

これで元の記事の Like やらは消えました。
まあほとんどなかったので、少数の方にはもうしわけないっですが、生みの痛みということでご了承ねがいたく。

### 結論

slug 設計は計画的に。

## Zennコンテンツのslug2

### 序

リポジトリ管理で新規記事を作るのは `zenn new:article` ですが、これを `npm run new-article` にしてあります。

### 問題

ただこれで作ると slug が乱数です。
独自情報が面倒でコマンド定義したのにオプションを付けるのも面倒です。

### 結論

実際の所、リポジトリに入れたファイルがどうなるか、です。
ファイル内にこの乱数な slug と関係のある部分はないです。

なので、コミット前に必要な名前にリネームすればOKでした。

## 結び

参考になれば幸いです。

